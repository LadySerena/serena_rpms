/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

task downloadMinecraftJars(type: Download){
    src 'https://launcher.mojang.com/v1/objects/4d1826eebac84847c71a77f9349cc22afd0cf0a1/server.jar'
    dest buildDir
    overwrite false
}

task buildMinecraft(type: Rpm) {
    dependsOn downloadMinecraftJars
    packageName 'minecraft'
    version '1.15.1'
    release '1'
    arch 'NOARCH'
    os 'Linux'
    requires('java-11-openjdk-headless')
    preInstall file('scripts/preInstall.sh')
    postInstall file('scripts/postInstall.sh')
    from('opt/minecraft') {
        into '/opt/minecraft'
        user 'minecraft'
        permissionGroup 'minecraft'
        fileMode 0644

    }
    from(buildDir) {
        into '/opt/minecraft'
        include 'server.jar'
        user 'minecraft'
        permissionGroup 'minecraft'
        fileMode 0644
    }
    from('etc/systemd') {
        into '/etc/systemd/system'
        user'root'
        permissionGroup 'root'
        fileMode 0644
    }
}
